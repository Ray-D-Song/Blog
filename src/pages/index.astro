---
import { getCollection } from 'astro:content';
import Layout from '../layouts/Layout.astro';
import {formatDate} from '../utils/date'
import Card from '@/components/Card.astro';

const blogs = await getCollection('blog')
---

<Layout title="Ray-D-Song's Blog: Programming & Tech" lang="zh-CN" desc="Explore Ray-D-Song's Blog for insights on programming">
	<main class="flex flex-col justify-center items-center gap-8">
    {
      blogs
      .sort((a, b) => (new Date(b.data.date)).getTime() - (new Date(a.data.date)).getTime())
      .map(blog => (
        <Card blog={blog} />
      ))
    }
	</main>
</Layout>

<script>
const uls = document.querySelectorAll('ul')

const langCache = window.localStorage.getItem('language')
const userLang = langCache || navigator.language

uls.forEach((ul) => {
  if(userLang === 'zh-CN') {
    if(!ul.dataset.slug?.includes('zh-cn')) {
      ul.style.display = 'none'
    }
  } else {
    if(ul.dataset.slug?.includes('zh-cn')) {
      ul.style.display = 'none'
    }
  }

})
</script>